require=function s(a,r,c){function h(e,t){if(!r[e]){if(!a[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(l)return l(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var o=r[e]={exports:{}};a[e][0].call(o.exports,function(t){return h(a[e][1][t]||t)},o,o.exports,s,a,r,c)}return r[e].exports}for(var l="function"==typeof require&&require,t=0;t<c.length;t++)h(c[t]);return h}({Defense:[function(t,e,i){"use strict";cc._RF.push(e,"9f28a4vQuFLHoZAT/jmtbZM","Defense");var n=t("Resource");cc.Class({extends:n,properties:{},start:function(){},die:function(){this._super();var t=function(){this.node.destroy()}.bind(this);this.node.setColor(cc.Color.WHITE);var e=cc.sequence(cc.tintTo(.5,255,0,0),cc.tintTo(.5,255,255,255),cc.callFunc(t));this.node.runAction(e)},update:function(t){}});cc._RF.pop()},{Resource:"Resource"}],Drone:[function(t,e,i){"use strict";cc._RF.push(e,"d8521eGHLxPWJZAIeO0y9Ki","Drone");var n=t("Defense");cc.Class({extends:n,properties:{startTranslationAngle:{default:0},translationSpeed:{default:3},translationRadius:{default:200},rotationSpeed:{default:100},crosshairPrefab:{default:null,type:cc.Prefab},_crosshair:{default:null,type:cc.Node}},onLoad:function(){this._crosshair=cc.instantiate(this.crosshairPrefab),this._crosshair.parent=this.node.parent},start:function(){this.threat=null,this.turret=this.node.getChildByName("turret"),this._cTime=0,this._timeout=3,this.threatList=[],this.cTranslationAngle=this.startTranslationAngle,this.metralhadoraAction=cc.sequence(cc.callFunc(this.atirar,this),cc.delayTime(.4),cc.callFunc(this.atirar,this),cc.delayTime(.4),cc.callFunc(this.atirar,this))},lockOn:function(t){var e=Math.atan2(t.y-this.node.y,t.x-this.node.x);return this._crosshair.opacity=255,this._crosshair.position=t,cc.radiansToDegrees(-e)+90},mirar:function(t,e){t>this.turret.rotation?this.turret.rotation+=this.rotationSpeed*e:t<this.turret.rotation&&(this.turret.rotation-=this.rotationSpeed*e)},atirar:function(){this.game.spawnProjectile(this.turret)},onCollisionEnter:function(t,e){console.log("(DEFENSE) colidiu"),console.log("(DEFENSE) GROUP: "+t.node.group),console.log("(DEFENSE) TAG: "+t.tag),console.log("(DEFENSE) SELF TAG: "+e.tag),"ameaça"==t.node.group&&1==e.tag&&(t.node.getComponent("Threat").explosivel||(this.threatList.length<=0&&(this.threat=t.node),this.threatList.push(t.node)))},onCollisionExit:function(t,e){this.removeThreatFromList(t.node),t.node==this.threat&&(this.threat=this.threatList.pop())},removeThreatFromList:function(t){for(var e=0,i=this.threatList.length;e<i;e++)t==this.threatList[e]&&this.threatList.splice(e,1)},update:function(t){this.node.position=cc.p(Math.cos(cc.degreesToRadians(this.cTranslationAngle))*this.translationRadius,Math.sin(cc.degreesToRadians(this.cTranslationAngle))*this.translationRadius),this.cTranslationAngle+=this.translationSpeed*t,360<this.cTranslationAngle&&(this.cTranslationAngle=0),this.threat?(this.mirar(this.lockOn(this.threat.getPosition()),t),this._cTime+=t,this._cTime>=this._timeout&&(this.atirar(),this._cTime=0)):this._crosshair.opacity=0},onDestroy:function(){this._crosshair.destroy()}});cc._RF.pop()},{Defense:"Defense"}],Fragment:[function(t,e,i){"use strict";cc._RF.push(e,"e29b4Tn6LVF4pCm+m4ujHD0","Fragment");var n=t("Threat");cc.Class({extends:n,properties:{},start:function(){},init:function(t){this.game=t,this.initMotion()},initMotion:function(){var t=Math.round(30*cc.random0To1()+70),e=Math.round(360*cc.random0To1()+0),i=cc.p(Math.cos(cc.degreesToRadians(e))*t,Math.sin(cc.degreesToRadians(e))*t),n=cc.pDistance(this.node.position,cc.p(i.x+this.node.x,i.y+this.node.y))/this.speed,o=cc.moveBy(n,i),s=function(){console.log("destroyed"),this.game.onThreatDestroy(this),this.node.destroy()}.bind(this),a=cc.sequence(o,cc.callFunc(s));this.node.runAction(a)},update:function(t){}});cc._RF.pop()},{Threat:"Threat"}],Main:[function(t,e,i){"use strict";cc._RF.push(e,"280c3rsZJJKnZ9RqbALVwtK","Main");var n=cc.Class({extends:cc.Component,properties:{turret:{default:null,type:cc.Node},turretAtlas:{default:null,type:cc.SpriteAtlas},rotationSpeed:{default:1},defaultLaserReloadTime:{default:0,tooltip:"Reload Time do Laser Default"},otherLaserReloadTime:{default:0,tooltip:"Reload Time do Laser Rápido"},boostTime:{default:1,displayName:"Reload Time Boost",tooltip:"Reload Time Boost"},laserPrefab:{default:null,type:cc.Prefab},otherLaserPrefab:{default:[],type:[cc.Prefab]},shieldPrefab:{default:null,type:cc.Prefab},dronePrefab:{default:null,type:cc.Prefab},waveDataNameList:{default:[],type:[cc.String],tooltip:'Forneça uma sequencia de nomes de arquivos json com os dados da wave, eles devem ser encontrados na pasta "assets/resources/"'},_cTime:0,points:{default:0,visible:!1},_gameOver:!1},statics:{LASER_DEFAULT:-1,LASER_RAPID1:0,LASER_RAPID2:1},onLoad:function(){cc.director.getCollisionManager().enabled=!0,this.reloadBar=cc.find("Canvas/Interface/reloadBar").getComponent(cc.ProgressBar),this.city=cc.find("Canvas/city"),this.defense_facility=cc.find("Canvas/defense_facility"),this.power_plant=cc.find("Canvas/power_plant"),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},start:function(){this.turret.getComponent("Resource").init(this),this.city.getComponent("Resource").init(this),this.defense_facility.getComponent("Resource").init(this),this.power_plant.getComponent("Resource").init(this),this.rotateLeft=!1,this.rotateRight=!1,this.shootPermit=!1,this.projectileActiveCode=n.LASER_DEFAULT,this.reloadTime=this.defaultLaserReloadTime,this.currentBoostTime=1,this._carregarMunicao=!0,this.numberOfWaves=this.waveDataNameList.length,this.currentWaveIdx=0,this.startNewWave()},_loadWaveAndProcessIt:function(t){cc.loader.loadRes(t,function(t,e){this.currentWave=this.getComponent("Wave"),this.currentWave.init(e),console.log("(WAVE) remaining threats: "+this.currentWave.remainingThreats),this._processWave(),this.updateInterface()}.bind(this))},_processWave:function(){var t=this.currentWave.extractThreat();t&&this.spawnThreat(t);var i=function(){var t=this.currentWave.extractThreat();if(t&&this.spawnThreat(t),console.log("(WAVE) remaining threats: "+this.currentWave.remainingThreats),this.currentWave.waveIsOver())console.log("(WAVE) Wave Is Over"),this.node.stopAllActions(),this.onCurrentWaveOver();else{var e=cc.sequence(cc.delayTime(Number(t.interval)),cc.callFunc(i));this.node.runAction(e)}}.bind(this),e=cc.sequence(cc.delayTime(Number(t.interval)),cc.callFunc(i));this.node.runAction(e)},getPositionInOtherNode:function(t,e){if(null==e.parent)return null;var i=e.parent.convertToWorldSpaceAR(e.getPosition());return t.convertToNodeSpaceAR(i)},spawnProjectile:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=t||this.turret;if(e)var o=cc.instantiate(this.otherLaserPrefab[i]),s=n.getChildByName("init_pos2");else o=cc.instantiate(this.laserPrefab),s=n.getChildByName("init_pos");var a=n.getChildByName("mira");o.setPosition(this.getPositionInOtherNode(this.node,s)),o.setRotation(n.getRotation()+180),o.setScale(.5,.5),o.getComponent("Projectile").init(this,this.getPositionInOtherNode(this.node,a),n),this.node.insertChild(o,cc.find("Canvas/Interface").getSiblingIndex())},spawnThreat:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if("Spaceship"!=t.getComponent("Threat").tipo){var i=Math.round(360*cc.random0To1()+0);if(console.log("random_angle:"+i),e)n=this.getPositionInOtherNode(this.node,e);else var n=cc.p(600*Math.cos(cc.degreesToRadians(i)),600*Math.sin(cc.degreesToRadians(i)));console.log("init_pos:"+n),t.setPosition(n),t.setScale(.5,.5),"Asteroid"!=t.getComponent("Threat").tipo&&(t.setScale(1,1),t.setRotation(-1*i-90)),this.node.insertChild(t,cc.find("Canvas/Interface").getSiblingIndex()),t.getComponent("Threat").init(this)}else this.spawnSpaceship(t)},spawnAsteroidFragments:function(t){var e=t.getPosition(),i=this.getComponent("Wave").asteroidFragmentsPrefab.slice(0),n=Math.round(cc.random0To1()*(i.length-1-0)+0),o=cc.instantiate(i[n]);i.slice(n,1),n=Math.round(cc.random0To1()*(i.length-1-0)+0);var s=cc.instantiate(i[n]);i.slice(n,1),n=Math.round(cc.random0To1()*(i.length-1-0)+0);var a=cc.instantiate(i[n]);i.slice(n,1),o.setPosition(e),s.setPosition(e),a.setPosition(e),o.setScale(.5,.5),s.setScale(.5,.5),a.setScale(.5,.5),this.node.insertChild(o,cc.find("Canvas/Interface").getSiblingIndex()),this.node.insertChild(s,cc.find("Canvas/Interface").getSiblingIndex()),this.node.insertChild(a,cc.find("Canvas/Interface").getSiblingIndex()),o.getComponent("Fragment").tipo="Fragment",o.getComponent("Fragment").speed=20,o.getComponent("Fragment").pontos=1,o.getComponent("Fragment").maxHP=1,o.getComponent("Fragment").hp=1,s.getComponent("Fragment").tipo="Fragment",s.getComponent("Fragment").speed=20,s.getComponent("Fragment").pontos=1,s.getComponent("Fragment").maxHP=1,s.getComponent("Fragment").hp=1,a.getComponent("Fragment").tipo="Fragment",a.getComponent("Fragment").speed=20,a.getComponent("Fragment").pontos=1,a.getComponent("Fragment").maxHP=1,a.getComponent("Fragment").hp=1,o.getComponent("Fragment").init(this),s.getComponent("Fragment").init(this),a.getComponent("Fragment").init(this)},spawnSpaceship:function(t){var e=t.getComponent("Spaceship");t.setScale(.5,.5),e.init(this,t.shipPos),e.beginMotion(),this.node.insertChild(t,cc.find("Canvas/Interface").getSiblingIndex())},spawnShield:function(){if(!cc.find("Canvas/shield")){var t=cc.instantiate(this.shieldPrefab);t.getComponent("Resource").init(this),this.updateInterface(t.getComponent("Resource")),this.node.insertChild(t,cc.find("Canvas/Interface").getSiblingIndex())}},spawnDrone:function(){var i=[0,90,180,270];if(this.node.children.forEach(function(t){if("spaceBuilding_014"==t.name){var e=t.getComponent("Drone");i.splice(i.indexOf(e.startTranslationAngle),1)}},this),0<i.length){var t=cc.instantiate(this.dronePrefab),e=i[Math.round(cc.random0To1()*(i.length-1))];t.getComponent("Drone").init(this),t.getComponent("Drone").startTranslationAngle=e,this.updateInterface(t.getComponent("Resource")),this.node.insertChild(t,cc.find("Canvas/Interface").getSiblingIndex())}},spawnThreatRandTarget:function(){var t=[this.defense_facility,this.power_plant,this.city],e=Math.round(2*cc.random0To1());this.spawnThreat(t[e])},applyEffects:function(){var t=this.turret.getComponent("Resource"),e=this.city.getComponent("Resource"),i=this.defense_facility.getComponent("Resource"),n=this.power_plant.getComponent("Resource");(t.died||e.died&&i.died&&n.died)&&(this._gameOver=!0);var o=0;o+=e.died?0:1,o+=i.died?0:1,o+=n.died?0:1;var s=this.points*o,a={};a.pontos=this.points,a.numRecursos=o,a.total=s,this.points=s,this._showEndWaveInterface(a)},startNewWave:function(){var t=this.waveDataNameList.shift();console.log("(NEW WAVE) STARTING NEW WAVE"),console.log("(NEW WAVE) WAVE NAME: "+t),t&&(this.currentWaveIdx++,this._loadWaveAndProcessIt(t),this.schedule(this._verifySpace,.5))},switchLaser:function(){switch(this.projectileActiveCode){case n.LASER_DEFAULT:this.turret.getComponent(cc.Sprite).spriteFrame=this.turretAtlas.getSpriteFrame("turret_w2"),this.projectileActiveCode=n.LASER_RAPID2,this.reloadTime=this.otherLaserReloadTime;break;case n.LASER_RAPID1:case n.LASER_RAPID2:this.turret.getComponent(cc.Sprite).spriteFrame=this.turretAtlas.getSpriteFrame("turret_w1"),this.projectileActiveCode=n.LASER_DEFAULT,this.reloadTime=this.defaultLaserReloadTime}this.shootPermit=!1,this._cTime=0},cleanSpace:function(){this.node.children.forEach(function(t){t.getComponent("Fragment")&&(t.stopAllActions(),t.destroy())},this)},_haveFragments:function(){for(var t=this.node.children.length,e=0;e<t;e++){var i=this.node.children[e];if(i.getComponent("Fragment")&&cc.isValid(i))return!0}return!1},onThreatHit:function(){this.reloadBar.node.getChildByName("bar").setColor(cc.Color.GREEN),this.currentBoostTime=this.boostTime},onDamage:function(t,e){var i=e.getComponent("Resource");switch(t.tipo){case"Virus":case"EMP":break;case"EnemyProjectile":if("turret"==e.name){var n=function(){this._carregarMunicao=!1,this.shootPermit=!1,this._cTime=0,this.currentBoostTime=1,this.reloadBar.progress=0,this.reloadBar.node.getChildByName("bar").setColor(cc.Color.WHITE),this.turret.setOpacity(150)}.bind(this),o=function(){this._carregarMunicao=!0,this.turret.setOpacity(255)}.bind(this),s=cc.sequence(cc.callFunc(n),cc.delayTime(2),cc.callFunc(o));this.node.runAction(s)}}i.damage(),this.updateInterface(i)},onThreatDestroy:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];if(i)switch(i.owner.name){case"spaceBuilding_014":this.points+=Math.round(.5*e);break;case"turret":this.points+=Math.round(e)}else this.points+=n?Math.round(1.1*e):Math.round(e);(!t||"EnemyProjectile"!=t.tipo&&"Fragment"!=t.tipo)&&this.currentWave.onThreatDestroy(),this.updateInterface(),"Asteroid"==t.tipo&&i&&this.spawnAsteroidFragments(t.node)},onResourceDie:function(t){console.log(t.name+" died =´("),t.node==this.turret&&(this._carregarMunicao=!1,this.shootPermit=!1,this._cTime=0,this.currentBoostTime=1,this.reloadBar.progress=0,this.reloadBar.node.getChildByName("bar").setColor(cc.Color.WHITE))},onResourceRevived:function(t){console.log(t.node.name+" revived!! =D"),t.node==this.turret&&(this._carregarMunicao=!0)},onCurrentWaveOver:function(){},onWaveDestroyed:function(){this.cleanSpace(),this.unschedule(this._verifySpace),this.applyEffects()},_verifySpace:function(){this.currentWave.waveDestroyed()&&!this._haveFragments()&&this.onWaveDestroyed()},update:function(t){this.rotateLeft&&(this.turret.rotation-=this.rotationSpeed*t),this.rotateRight&&(this.turret.rotation+=this.rotationSpeed*t),this._carregarMunicao&&(this._cTime+=t*this.currentBoostTime,this.reloadBar.progress=this._cTime/this.reloadTime,this._cTime>=this.reloadTime&&(this.shootPermit=!0,this._cTime=this.reloadTime))},updateInterface:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e=cc.find("Canvas/Interface");cc.find("ifDefense/layout/data",e).getComponent(cc.Label).string=this.defense_facility.getComponent("Resource").hp,cc.find("ifPower/layout/data",e).getComponent(cc.Label).string=this.power_plant.getComponent("Resource").hp,cc.find("ifCity/layout/data",e).getComponent(cc.Label).string=this.city.getComponent("Resource").hp,cc.find("ifPlayer/layout/data",e).getComponent(cc.Label).string=this.turret.getComponent("Resource").hp,cc.find("ifWave/layout/waveNum/data",e).getComponent(cc.Label).string=this.currentWaveIdx+"/"+this.numberOfWaves,cc.find("ifWave/layout/waveThreats/data",e).getComponent(cc.Label).string=this.currentWave.numberOfThreats-this.currentWave.threatsDestroyed+"/"+this.currentWave.numberOfThreats,cc.find("ifPoints/layout/data",e).getComponent(cc.Label).string=this.points,!t||"spaceBuilding_014"!=t.node.name&&"shield"!=t.node.name||(cc.find("interface/hp/data",t.node).getComponent(cc.Label).string=t.hp)},_showEndWaveInterface:function(t){var e=cc.find("Canvas/Interface/ifEndWave");if(cc.find("layout/data/values/txtPts",e).getComponent(cc.Label).string=t.pontos,cc.find("layout/data/values/txtNR",e).getComponent(cc.Label).string=t.numRecursos,cc.find("layout/data/values/txtTotal",e).getComponent(cc.Label).string=t.total,0==this.waveDataNameList.length||this._gameOver){var i=cc.find("layout/buttons/close",e);cc.find("label",i).getComponent(cc.Label).string="Restart",i.getComponent(cc.Button).clickEvents[0].customEventData="restart"}e.setPosition(0,0)},hideEndWaveInterface:function(t,e){e?cc.director.loadScene("main"):(cc.find("Canvas/Interface/ifEndWave").setPosition(1e3,0),this._gameOver||this.startNewWave())},addShield:function(){this.spawnShield()},addDrone:function(){this.spawnDrone()},onKeyDown:function(t){switch(t.keyCode){case cc.KEY.a:console.log("key a"),this.rotateLeft=!0,this.rotateRight=!1;break;case cc.KEY.d:console.log("key d"),this.rotateRight=!0,this.rotateLeft=!1;break;case cc.KEY.r:this.switchLaser();break;case cc.KEY.space:if(console.log("key space"),this.shootPermit){switch(this.projectileActiveCode){case n.LASER_RAPID1:case n.LASER_RAPID2:this.spawnProjectile(null,!0,this.projectileActiveCode);break;default:case n.LASER_DEFAULT:this.spawnProjectile()}this.shootPermit=!1,this._cTime=0,this.currentBoostTime=1,this.reloadBar.node.getChildByName("bar").setColor(cc.Color.WHITE)}else console.log("nao permitido")}},onKeyUp:function(t){switch(t.keyCode){case cc.KEY.a:console.log("release a"),this.rotateLeft=!1;break;case cc.KEY.d:console.log("release d"),this.rotateRight=!1;break;case cc.KEY.space:console.log("release space")}}});cc._RF.pop()},{}],Projectile:[function(t,e,i){"use strict";cc._RF.push(e,"5f897B3TI5EQbzSvim2NxHT","Projectile");var n=t("Threat");cc.Class({extends:cc.Component,properties:{speed:{default:1},dano:{default:10},owner:{default:null,type:cc.Node,visible:!1}},start:function(){},init:function(t,e,i){this.game=t,this.owner=i;var n=cc.pDistance(this.node.position,e)/this.speed,o=cc.moveTo(n,e),s=this,a=cc.sequence(o,cc.callFunc(function(){console.log("destroyed"),s.node.destroy()}));this.node.runAction(a)},onCollisionEnter:function(t,e){"ameaça"==t.node.group&&t.tag!=n.TAG_EXPLOSION&&(this.game.onThreatHit(),this.node.destroy())},update:function(t){}}),cc._RF.pop()},{Threat:"Threat"}],Resource:[function(t,e,i){"use strict";cc._RF.push(e,"cb086nqYOZChKbqj42MoOcy","Resource");cc.Class({extends:cc.Component,properties:{initialHP:{default:5,tooltip:"O recurso irá começar com essa quantidade de HP"},maxHP:{default:5,tooltip:"HP máximo do recurso, não deve ser menor que Initial HP"},hp:{get:function(){return this._hp},set:function(t){t<0?this._hp=0:t>this.maxHP?this._hp=this.maxHP:this._hp=t,0<this._hp&&this.revive()},visible:!1},died:{default:!1,visible:!1}},start:function(){},init:function(t){this.game=t,this.hp=this.initialHP,this.node.setColor(cc.Color.WHITE),console.log(this.node.name+" current HP: "+this.hp)},damage:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;this.hp-=t;var e=cc.sequence(cc.tintTo(.5,255,0,0),cc.tintTo(.5,255,255,255));this.node.runAction(e),0==this.hp&&this.die(),console.log(this.node.name+" current HP: "+this.hp)},die:function(){this.node.stopAllActions(),this.node.setColor(cc.Color.RED),this.died=!0,this.game.onResourceDie(this)},revive:function(){this.died&&(this.died=!1,this.game.onResourceRevived(this)),this.node.setColor(cc.Color.WHITE)}});cc._RF.pop()},{}],Spaceship:[function(t,e,i){"use strict";cc._RF.push(e,"76799cOtCFOj6IIDNqtgmm7","Spaceship");var n=t("Threat");cc.Class({extends:n,properties:{rotationSpeed:{default:100},projectilePrefab:{default:null,type:cc.Prefab}},start:function(){},init:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.game=t,this._pos=e},beginMotion:function(){var t=this.getComponent(cc.Animation);t.getClips()[this._pos].speed=this.speed,0<this._pos?t.play("motion"+this._pos):t.play("motion")},lockOn:function(t){var e=Math.atan2(t.y-this.node.y,t.x-this.node.x);return cc.radiansToDegrees(-e)+90},mirar:function(t,e){t>this.node.rotation?this.node.rotation+=this.rotationSpeed*e:t<this.node.rotation&&(this.node.rotation-=this.rotationSpeed*e)},atirar:function(){var t=cc.instantiate(this.projectilePrefab);t.getComponent("Threat").tipo="EnemyProjectile",t.getComponent("Threat").speed=100,t.getComponent("Threat").pontos=1,t.getComponent("Threat").maxHP=1,t.getComponent("Threat").hp=1,t.getComponent("Threat").target=this.target,t.runAction(cc.repeatForever(cc.rotateBy(1,360))),this.game.spawnThreat(t,this.node.getChildByName("init_pos"))},onHalfCompleted:function(){this.atirar()},onAnimCompleted:function(){this.game.onThreatDestroy(this),this.node.destroy()},update:function(t){this.mirar(this.lockOn(this.target.getPosition()),t)}});cc._RF.pop()},{Threat:"Threat"}],Threat:[function(t,e,i){"use strict";cc._RF.push(e,"b284bI/tjNLEqci5YLPY85d","Threat");var r=cc.Class({extends:cc.Component,properties:{speed:{default:1},target:{default:null,type:cc.Node},maxHP:{default:0,visible:!1},hp:{get:function(){return this._hp},set:function(t){t<0?this._hp=0:t>this.maxHP?this._hp=this.maxHP:this._hp=t},visible:!1},pontos:{default:0,visible:!1},tipo:{default:null,visible:!1},explosivel:{default:!1,visible:!1}},statics:{TAG_DEFENSE_FACILITY:1,TAG_POWER_PLANT:2,TAG_CITY:3,TAG_DEFENSE:4,TAG_EXPLOSION:5},start:function(){},init:function(t){this.game=t;var e=this.target.getPosition(),i=cc.pDistance(this.node.position,e),n=(this.initialTargetDistance=i)/this.speed,o=cc.moveTo(n,e),s=function(){console.log("destroyed"),this.game.onDamage(this,this.target),this.game.onThreatDestroy(this),this.node.destroy()}.bind(this),a=cc.sequence(o,cc.callFunc(s));"Asteroid"==this.tipo&&this.node.runAction(cc.repeatForever(cc.rotateBy(5,360))),this.node.runAction(a)},onCollisionEnter:function(t,e){switch(console.log("colidiu"),console.log("GROUP: "+t.node.group),console.log("TAG: "+t.tag),t.node.group){case"recurso":t.tag==r.TAG_DEFENSE&&e.tag!=r.TAG_EXPLOSION&&(console.log("destroyed"),this.game.onDamage(this,t),this.game.onThreatDestroy(this),this.node.destroy());break;case"projetil":if(e.tag!=r.TAG_EXPLOSION&&!e.node.exploded){var i=t.node.getComponent("Projectile");this.hp-=i.dano;var n=cc.sequence(cc.tintTo(.3,255,0,0),cc.tintTo(.3,255,255,255));if(this.node.runAction(n),0==this.hp){var o=this.pontos;if("Spaceship"!=this.tipo&&"Fragment"!=this.tipo){var s=this.target.getPosition(),a=cc.pDistance(e.node.position,s);o=this.pontos*(a/this.initialTargetDistance)}if(this.explosivel)cc.find("explosionFX",this.node).getComponent(cc.ParticleSystem).resetSystem(),this.getComponent(cc.Animation).play("explosion"),this.getComponent(cc.Animation).playAdditive("explosionTrace"),this.node.exploded=!0;else this.node.destroy();this.game.onThreatDestroy(this,o,i)}}break;case"ameaça":if(t.tag==r.TAG_EXPLOSION&&t.node.exploded&&(this.hp-=999,0==this.hp)){o=this.pontos;if("Spaceship"!=this.tipo&&"Fragment"!=this.tipo){s=this.target.getPosition(),a=cc.pDistance(e.node.position,s);o=this.pontos*(a/this.initialTargetDistance)}if(this.explosivel)cc.find("explosionFX",this.node).getComponent(cc.ParticleSystem).resetSystem(),this.getComponent(cc.Animation).play("explosion"),this.getComponent(cc.Animation).playAdditive("explosionTrace"),this.exploded=!0;else this.node.destroy();this.game.onThreatDestroy(this,o,null,!0)}}},onAnimExplosionColliderCompleted:function(){this.node.destroy()},update:function(t){}});cc._RF.pop()},{}],Wave:[function(t,e,i){"use strict";cc._RF.push(e,"07db1GY4sVM2qDmYJTDFGxn","Wave");t("Threat"),cc.Class({extends:cc.Component,properties:{waveData:{default:null,visible:!1},asteroidPrefab:{default:null,type:cc.Prefab},asteroidFragmentsPrefab:{default:[],type:[cc.Prefab]},virusPrefab:{default:null,type:cc.Prefab},empPrefab:{default:null,type:cc.Prefab},spaceShipPrefab:{default:null,type:cc.Prefab},cityNode:{default:null,type:cc.Node},defenseNode:{default:null,type:cc.Node},powerPlantNode:{default:null,type:cc.Node}},onLoad:function(){},start:function(){},init:function(t){this.waveData=t,this.numberOfThreats=this.waveData.threats.length,this.remainingThreats=this.numberOfThreats,this.threatsDestroyed=0,console.log("(WAVE) threats num: "+this.remainingThreats)},waveIsOver:function(){return 0==this.remainingThreats},extract:function(){return this.remainingThreats-=1,this.waveIsOver()},extractThreat:function(){var t=this.waveData.threats[this.getThreatIdx()];if(!t)return null;switch(t.tipo){case"Asteroid":var e=cc.instantiate(this.asteroidPrefab);break;case"Virus":e=cc.instantiate(this.virusPrefab);break;case"EMP":e=cc.instantiate(this.empPrefab);break;case"Spaceship":e=cc.instantiate(this.spaceShipPrefab)}switch(t.target){case"City":var i=this.cityNode;break;case"Defense":i=this.defenseNode;break;case"Power":i=this.powerPlantNode;break;case"Player":i=cc.find("Canvas/turret")}return e.getComponent("Threat").tipo=t.tipo,e.getComponent("Threat").speed=t.speed,e.getComponent("Threat").pontos=Number(t.pontos),e.getComponent("Threat").maxHP=Number(t.hp),e.getComponent("Threat").hp=Number(t.hp),e.getComponent("Threat").explosivel=Boolean(t.explosivel),e.getComponent("Threat").target=i,e.interval=t.interval,e.shipPos=Number(t.shipPos),this.remainingThreats-=1,e},onThreatDestroy:function(){this.threatsDestroyed++},waveDestroyed:function(){return this.threatsDestroyed>=this.numberOfThreats},getThreatIdx:function(){return this.numberOfThreats-this.remainingThreats}});cc._RF.pop()},{Threat:"Threat"}]},{},["Defense","Drone","Fragment","Main","Projectile","Resource","Spaceship","Threat","Wave"]);